# Ecoflow Cloud API credentials
ECOFLOW_USERNAME=""
ECOFLOW_PASSWORD=""

ECOFLOW_ACCESS_KEY=""
ECOFLOW_SECRET_KEY=""

# Comma-separated list of your Device Serial Numbers
ECOFLOW_DEVICE_LIST="R61ZE4WH30199,R631ZB41305"

###############################################################################################

# MQTT
MQTT_HOST=mosquitto
MQTT_PORT=1883
MQTT_USER=
MQTT_PASS=

# EcoFlow base
ECOFLOW_BASE=bridge-ecoflow

# --- Policy Configuration ---
# The battery percentage threshold. If the UPS battery drops to or below this level
# while the grid is disconnected, a shutdown sequence will be considered.
POLICY_SOC_MIN=10
# The safety timer (in seconds). The critical condition (Grid Lost AND Low Battery)
# must remain active continuously for this entire duration before a shutdown is actually triggered.
# This prevents shutdowns during momentary power flickers or data glitches.
POLICY_DEBOUNCE_SEC=180
# The "mute" timer (in seconds). After a shutdown command is sent, the system will wait
# this long before sending another command to the same device, even if the battery remains low.
# This prevents spamming the shutdown command repeatedly while the device is powering off.
POLICY_COOLDOWN_SEC=300

# Mapping (simple JSON string to avoid extra files for now)
# device -> list of agent_ids to shut down
DEVICE_TO_AGENTS_JSON={"STUDY":["pc-study","nas-thecus"],"Meterkast":["pc-meterkast"]}

# Agent identity
AGENT_ID=pc-study

# Agent commands (run in order)
PRE_SHUTDOWN_CMD_1="microk8s stop"
# PRE_SHUTDOWN_CMD_2="systemctl stop something"
SHUTDOWN_CMD="shutdown -h now"

# Windows examples:
# PRE_SHUTDOWN_CMD_1="powershell -NoProfile -Command Stop-Service -Name 'microk8s' -Force"
# SHUTDOWN_CMD="shutdown.exe /s /t 60 /f /c \"EcoFlow low battery\""
